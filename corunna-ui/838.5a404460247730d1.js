"use strict";(self.webpackChunkcorunna_ui=self.webpackChunkcorunna_ui||[]).push([[838],{838:(C,d,e)=>{e.r(d),e.d(d,{StaffServiceHistoryPageModule:()=>j});var f=e(9595),c=e(4201),s=e(8118),u=e(8115),a=e(895),Z=e(5119),l=e(8033),g=e(2457),h=e(6177),v=e(4850),t=e(4650),M=e(2412),D=e(6895),y=e(4006),O=e(161),b=e(2216),p=e(9492),S=e(2879);function P(n,T){if(1&n&&(t.TgZ(0,"swiper-slide",15)(1,"label",16)(2,"span"),t._uU(3),t.TgZ(4,"sup"),t._uU(5,"%"),t.qZA()(),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"number"),t.TgZ(9,"sub"),t._uU(10,"c"),t.qZA()()(),t.TgZ(11,"h2",17),t._uU(12),t.ALo(13,"number"),t.qZA()()),2&n){const o=T.$implicit;t.xp6(3),t.hij(" ",null==o?null:o._id,""),t.xp6(4),t.hij(" ",t.lcZ(8,3,null==o?null:o.commissionAmount),""),t.xp6(5),t.hij(" ",t.lcZ(13,5,null==o?null:o.cost)," ")}}const A=function(){return{header:"SVC",field:"serviceName"}},H=function(){return{header:"AMT",field:"serviceCost"}},w=function(){return{header:"COM (%)",field:"serviceCommission"}},x=function(){return{header:"X",field:"numOfTimes"}},U=function(){return{header:"DATE",field:"createdAt"}},J=function(n,T,o,r,i){return[n,T,o,r,i]};function B(n,T){if(1&n){const o=t.EpF();t.TgZ(0,"ion-toolbar",18)(1,"ion-title"),t._uU(2),t.qZA(),t.TgZ(3,"ion-icon",19),t.NdJ("click",function(){t.CHM(o),t.oxw();const i=t.MAs(18);return t.KtG(null==i?null:i.dismiss())}),t.qZA()(),t._UZ(4,"prime-table",20)}if(2&n){const o=t.oxw();t.xp6(2),t.Oqu(null==o.selectedStaff?null:o.selectedStaff.staffName),t.xp6(2),t.Q6J("columns",t.qbA(9,J,t.DdM(4,A),t.DdM(5,H),t.DdM(6,w),t.DdM(7,x),t.DdM(8,U)))("data",null==o.selectedStaff?null:o.selectedStaff.services)("rowsPerPage",5)}}const E=function(){return{dateInputFormat:"DD/MM/YYYY",containerClass:"theme-blue",adaptivePosition:!0}},N=[{path:"",component:(()=>{class n{constructor(o,r,i,m,_,L,F){this.modalCtrl=o,this.systemConfigService=r,this.dashbaorderServcieService=i,this.menuService=m,this.router=_,this.localStorageService=L,this.platform=F,this.sDate=new Date,this.eDate=new Date,this.serviceHistory={},this.columns=[{field:"staffName",header:"STAFF"},{field:"serviceCost",header:"AMT"},{field:"commissionAmount",header:"COM"}],this.rowContextMenu=[{name:"Details",clickAction:()=>{this.staffDetail()}}],this.detailOpen=!1}ngOnInit(){this.staff=JSON.parse(this.localStorageService.get("staff-profile")||"{}"),this.systemConfigService.getSystemConfig().subscribe(o=>{this.settings=o,"Daily"==this.settings.commissionRange&&(this.sDate=(0,u.Z)(new Date)),"Weekly"==this.settings.commissionRange&&(this.sDate=(0,a.Z)(new Date)),"Monthly"==this.settings.commissionRange&&(this.sDate=(0,Z.Z)(new Date)),this.getServiceHistory()}),this.getServiceHistory()}ngOnDestroy(){}getServiceHistory(){this.dashbaorderServcieService.getDashboardServices(this.sDate,this.eDate).subscribe(o=>{this.serviceHistory=o})}closeModal(){this.detailOpen?(this.router.navigate(["Super"==this.staff.acctType?"/super/hair-home":this.staff.acctType?.toLowerCase()]),this.modal?.isOpen&&this.modalCtrl?.dismiss("","","detail-modal"),this.modal?.dismiss()):(this.router.navigate(["Super"==this.staff.acctType?"/super/hair-home":this.staff.acctType?.toLowerCase()]),this.modal?.isOpen&&this.modalCtrl?.dismiss("","","staff-service"),this.modal?.dismiss())}staffDetail(){this.selectedStaff=this.menuService.contextRow?.rowData,this.selectedStaff.services=this.selectedStaff?.services?.map(o=>({serviceName:o.serviceName,serviceCost:o.serviceCost,serviceCommission:o.serviceCommission,numOfTimes:o.numOfTimes,createdAt:(0,l.Z)(new Date(o.createdAt||new Date),"d/M/yy - h:ma")})),this.menuService.closeAllMenu(),this.modal.present().then(()=>{this.detailOpen=!0,history.pushState({detail:!0,desc:"fake state for our modal"},null)}),this.modal.onDidDismiss().then(()=>{this.detailOpen=!1,this.selectedStaff=null})}static#t=this.\u0275fac=function(r){return new(r||n)(t.Y36(s.IN),t.Y36(h.c),t.Y36(g.D),t.Y36(c.hl),t.Y36(f.F0),t.Y36(v.n2),t.Y36(M.t4))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["healmah-staff-service-history"]],viewQuery:function(r,i){if(1&r&&t.Gf(s.ki,5),2&r){let m;t.iGM(m=t.CRH())&&(i.modal=m.first)}},hostBindings:function(r,i){1&r&&t.NdJ("popstate",function(_){return i.closeModal(_)},!1,t.Jf7)},decls:20,vars:16,consts:[["color","primary"],["slot","start"],["color","light",3,"defaultHref"],["color","light","slot","end"],[1,"flex","gap:5","p:10","{b:#0F85E9!}_input"],["type","text","bsDatepicker","",1,"form-control",3,"ngModel","bsConfig","ngModelChange"],[1,"btn","btn-outline-primary",3,"click"],["icon","search"],[1,"p:10"],[1,"bg:rgba(14,124,217,0.5)","r:10px",3,"auto","loop","pagination"],["class","min-h:100px p:10 f:white! f:1.1rem",4,"ngFor","ngForOf"],[1,"p:4"],[3,"columns","data","rowsPerPage","rowContextMenu","rowContextMenuEventType"],["id","detail-modal","scrollbar","",1,"$min-width:90vw!"],["modal",""],[1,"min-h:100px","p:10","f:white!","f:1.1rem"],[1,"flex","jc:space-evenly"],[1,"text-align:center","f:bold","f:1.6rem"],[1,"pr:15"],["slot","start","name","close-outline","slot","end",3,"click"],[3,"columns","data","rowsPerPage"]],template:function(r,i){1&r&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title",3),t._uU(5,"Service by Staff"),t.qZA()()(),t.TgZ(6,"ion-content")(7,"div",4)(8,"input",5),t.NdJ("ngModelChange",function(_){return i.sDate=_}),t.qZA(),t.TgZ(9,"input",5),t.NdJ("ngModelChange",function(_){return i.eDate=_}),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){return i.getServiceHistory()}),t._UZ(11,"fa-icon",7),t.qZA()(),t.TgZ(12,"main",8)(13,"swiper-container",9),t.YNc(14,P,14,7,"swiper-slide",10),t.qZA()(),t.TgZ(15,"main",11),t._UZ(16,"prime-table",12),t.qZA(),t.TgZ(17,"ion-modal",13,14),t.YNc(19,B,5,15,"ng-template"),t.qZA()()),2&r&&(t.xp6(3),t.Q6J("defaultHref",null==i.staff||null==i.staff.acctType?null:i.staff.acctType.toLowerCase()),t.xp6(5),t.Q6J("ngModel",i.sDate)("bsConfig",t.DdM(14,E)),t.xp6(1),t.Q6J("ngModel",i.eDate)("bsConfig",t.DdM(15,E)),t.xp6(4),t.Q6J("auto",!0)("loop",!1)("pagination",!0),t.xp6(1),t.Q6J("ngForOf",null==i.serviceHistory?null:i.serviceHistory.byCommission),t.xp6(2),t.Q6J("columns",i.columns)("data",null==i.serviceHistory?null:i.serviceHistory.byStaff)("rowsPerPage",10)("rowContextMenu",i.rowContextMenu)("rowContextMenuEventType",i.platform.is("mobile")?"press":"conntextmenu"))},dependencies:[D.sg,y.Fj,y.JJ,y.On,O.A,s.Sm,s.W2,s.Gu,s.gu,s.wd,s.sr,s.ki,s.oU,b.BN,p.Np,p.Y5,S.I,D.JJ],styles:["[_nghost-%COMP%]{--ion-color-primary: #1F5BBC;--ion-color-primary-rgb: 56, 128, 255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255, 255, 255;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61, 194, 255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255, 255, 255;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #f3f3f3;--ion-color-tertiary-rgb: 82, 96, 255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9}"]})}return n})()}];let R=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.oAB({type:n});static#o=this.\u0275inj=t.cJS({imports:[f.Bz.forChild(N),f.Bz]})}return n})();var I=e(5115);let j=(()=>{class n{static#t=this.\u0275fac=function(r){return new(r||n)};static#e=this.\u0275mod=t.oAB({type:n});static#o=this.\u0275inj=t.cJS({imports:[v._o,v.Nu,I.gw,R]})}return n})()},6177:(C,d,e)=>{e.d(d,{c:()=>u});var f=e(4850),c=e(9063),s=e(4650);let u=(()=>{class a extends f.q2{constructor(){super(c.ih.Setting,"rmd",!0),this.getSystemConfig().subscribe(l=>{this.systemConfig=l})}getDeleted(l,g,h){return this.get({endPoint:[c.wm.settingsQuery],params:[{k:"type",v:l},{k:"sDate",v:JSON.stringify(g)},{k:"eDate",v:JSON.stringify(h)}]})}saveSystemConfig(l){return this.post({payload:l,endPoint:[c.yv.settingsStore,c.yv.saveSettings]})}getSystemConfig(){return this.get({endPoint:[c.wm.settingsQuery,c.wm.getSettings]})}static#t=this.\u0275fac=function(g){return new(g||a)};static#e=this.\u0275prov=s.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})()},8115:(C,d,e)=>{e.d(d,{Z:()=>s});var f=e(953),c=e(833);function s(u){(0,c.Z)(1,arguments);var a=(0,f.Z)(u);return a.setHours(0,0,0,0),a}},5119:(C,d,e)=>{e.d(d,{Z:()=>s});var f=e(953),c=e(833);function s(u){(0,c.Z)(1,arguments);var a=(0,f.Z)(u);return a.setDate(1),a.setHours(0,0,0,0),a}},895:(C,d,e)=>{e.d(d,{Z:()=>a});var f=e(953),c=e(1998),s=e(833),u=e(8370);function a(Z,l){var g,h,v,t,M,D,y,O;(0,s.Z)(1,arguments);var b=(0,u.j)(),p=(0,c.Z)(null!==(g=null!==(h=null!==(v=null!==(t=l?.weekStartsOn)&&void 0!==t?t:null==l||null===(M=l.locale)||void 0===M||null===(D=M.options)||void 0===D?void 0:D.weekStartsOn)&&void 0!==v?v:b.weekStartsOn)&&void 0!==h?h:null===(y=b.locale)||void 0===y||null===(O=y.options)||void 0===O?void 0:O.weekStartsOn)&&void 0!==g?g:0);if(!(p>=0&&p<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var S=(0,f.Z)(Z),P=S.getDay(),A=(P<p?7:0)+P-p;return S.setDate(S.getDate()-A),S.setHours(0,0,0,0),S}}}]);