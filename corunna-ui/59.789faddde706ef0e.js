"use strict";(self.webpackChunkcorunna_ui=self.webpackChunkcorunna_ui||[]).push([[59],{59:(w,f,s)=>{s.r(f),s.d(f,{DashboardPageModule:()=>M});var h=s(9595),y=s(5478),A=s(1038),p=s(9063),o=s(4650),u=s(6895),c=s(4006),d=s(8118),C=s(2216),m=s(2054),b=s(9492);function Z(a,T){if(1&a&&(o.TgZ(0,"swiper-slide",15)(1,"ion-title",16),o._uU(2),o.qZA(),o.TgZ(3,"div",17)(4,"section")(5,"h2"),o._uU(6),o.ALo(7,"number"),o.qZA(),o.TgZ(8,"label"),o._uU(9,"Sales Profit"),o.qZA()(),o.TgZ(10,"section")(11,"h2"),o._uU(12),o.ALo(13,"number"),o.qZA(),o.TgZ(14,"label"),o._uU(15,"Expenditure"),o.qZA()()()()),2&a){const t=T.$implicit,e=o.oxw();let r,n;o.xp6(2),o.Oqu(t[0]),o.xp6(4),o.Oqu(o.lcZ(7,3,(null==(r=e.getBranchProfitAndExpense(t[0],t[1],"saleProfit"))?null:r.saleProfit)||0)),o.xp6(6),o.Oqu(o.lcZ(13,5,(null==(n=e.getBranchProfitAndExpense(t[0],t[1],"expenseAmount"))?null:n.expenseAmount)||0))}}const x=function(){return{dateInputFormat:"DD/MM/YYYY",containerClass:"theme-blue",adaptivePosition:!0}},v=[{path:"",component:(()=>{class a{constructor(t){this.dashboardService=t,this.sDate=(0,A.Z)(new Date,14),this.eDate=new Date,this.range="Daily",this.profitAndExpenditures=[],this.option={legend:{},tooltip:{trigger:"axis",showContent:!1},dataset:{source:[]},xAxis:{type:"category"},yAxis:{gridIndex:0},grid:{top:"55%"},series:[]},this.lines=[]}ngOnInit(){this.getDashboardData()}onChartInit(t){this.echartsInstance=t}getDashboardData(){this.dashboardService.getDashboardCharts(this.sDate,this.eDate,this.range).subscribe(t=>{const e=t?.profitAndExpenditure,r=Object.entries((0,p.Cf)(e,"_id"));this.profitAndExpenditures=r.sort((i,g)=>i[0]>g[0]?1:-1);const n=t?.branchDateRangeSales;this.formatChartData(n)})}getBranchProfitAndExpense(t,e,r){return e.find(n=>n._id==t&&n[r])}formatChartData(t){let e=[],r=[];for(let n=0;n<t.length;n++)t[n].dates.forEach(i=>{e.includes(i._id?.toString())||e.push(i._id?.toString())}),n==t.length-1&&(e=e.sort((i,g)=>i>g?1:-1),e.forEach((i,g)=>{for(let l=0;l<t.length;l++)t[l].dates.find(P=>P._id==i)||t[l].dates.push({_id:i,shopBranch:t[l]._id,saleAmount:0}),t[l].dates=(0,p.v4)(t[l].dates,"_id")}));e.unshift("dates"),t.forEach(n=>{r.push([n._id?.toString(),...n.dates.map(i=>i.saleAmount)])}),this.dataset={source:[e,...r]};for(let n=0;n<t.length;n++)this.lines.push({type:"line",smooth:!0,seriesLayoutBy:"row",emphasis:{focus:"series"}});this.onChartEvent({original:e[1]})}onChartEvent(t){t?.event&&"line"!==t.event.componentSubType||("click"==t?.event?.type&&(this.point=t.event.data[0]),this.series=[...this.lines,{type:"pie",id:"pie",radius:"30%",top:"25px",center:["50%","25%"],emphasis:{focus:"self"},label:{formatter:"({d}%)"},encode:{itemName:"dates",value:`${this.point?this.point:t.original}`}}],this.option={legend:{},tooltip:{trigger:"item",showContent:!0},dataset:this.dataset,xAxis:{type:"category",axisLabel:{interval:0,rotate:30}},yAxis:{gridIndex:0,axisLabel:{formatter:e=>e<1e3?e:e/1e3+"K"}},grid:{top:"55%"},series:this.series})}static#o=this.\u0275fac=function(e){return new(e||a)(o.Y36(y.s))};static#t=this.\u0275cmp=o.Xpm({type:a,selectors:[["healmah-dashboard"]],decls:24,vars:12,consts:[["color","primary"],["slot","start"],["color","light","defaultHref","super"],["slot","start","color","light"],[1,"p:10","pt:40"],[1,"flex","gap:5"],["type","text","bsDatepicker","","container","body",1,"form-control","text-center","shadow:none!","b:1|solid|#E27B4E!","rr:0!","rb:0!","rtl:20!",3,"bsConfig","ngModel","ngModelChange"],["type","text","bsDatepicker","","container","body",1,"form-control","text-center","shadow:none!","b:1|solid|#E27B4E!","rl:0!","rr:0!",3,"bsConfig","ngModel","ngModelChange"],[1,"form-control","form-select","shadow:none!","b:1|solid|#E27B4E!","rl:0!","rr:0!","flex-basis:75px",3,"ngModel","ngModelChange"],[1,"btn","bg:#E27B4E!","rl:0!","rtr:20!","rb:0!",3,"click"],["icon","search",1,"f:white!"],[1,"w:100%","r:0px","rb:20","mt:0","pb:10","$swiper-pagination-color:red!","$swiper-pagination-bottom:-1px!","bg:linear-gradient(#E27B4E,#FADAC4);","shadow:0|2px|4px|rgba(0,0,0,0.1)",3,"loop","pagination","slidesPerView"],["class","\n        min-h:100%  p:10 b:red! f:white! f:1.1rem d:flex! flex-direction:column gap:10!\n        {text-align:center}>h2 {flex:1;r:12px}>div\n      ",4,"ngFor","ngForOf"],[1,"mt:20"],["echarts","",1,"h:400",3,"options","chartInit","chartClick"],[1,"min-h:100%","p:10","b:red!","f:white!","f:1.1rem","d:flex!","flex-direction:column","gap:10!","{text-align:center}>h2","{flex:1;r:12px}>div"],[1,"text-align:center!","f:1.2rem!"],[1,"flex","gap:15","f:#E27B4E","text-align:center!","{flex:1;bg:#FADAC4;h:100%;r:12px;d:flex;flex-direction:column;jc:center;p:5}>section","{opacity:0.9;f:monospace;f:0.8rem;f:black}>section>label","{f:bold;f:1.2rem}>section>h2"]],template:function(e,r){1&e&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),o._UZ(3,"ion-back-button",2),o.qZA(),o.TgZ(4,"ion-title",3),o._uU(5,"Dashboard"),o.qZA()()(),o.TgZ(6,"ion-content")(7,"section",4)(8,"header",5)(9,"input",6),o.NdJ("ngModelChange",function(i){return r.sDate=i}),o.qZA(),o.TgZ(10,"input",7),o.NdJ("ngModelChange",function(i){return r.eDate=i}),o.qZA(),o.TgZ(11,"select",8),o.NdJ("ngModelChange",function(i){return r.range=i})("ngModelChange",function(){return r.getDashboardData()}),o.TgZ(12,"option"),o._uU(13,"Daily"),o.qZA(),o.TgZ(14,"option"),o._uU(15,"Weekly"),o.qZA(),o.TgZ(16,"option"),o._uU(17,"Monthly"),o.qZA()(),o.TgZ(18,"button",9),o.NdJ("click",function(){return r.getDashboardData()}),o._UZ(19,"fa-icon",10),o.qZA()(),o.TgZ(20,"swiper-container",11),o.YNc(21,Z,16,7,"swiper-slide",12),o.qZA()(),o.TgZ(22,"main",13)(23,"div",14),o.NdJ("chartInit",function(i){return r.onChartInit(i)})("chartClick",function(i){return r.onChartEvent({event:i})}),o.qZA()()()),2&e&&(o.xp6(9),o.Q6J("bsConfig",o.DdM(10,x))("ngModel",r.sDate),o.xp6(1),o.Q6J("bsConfig",o.DdM(11,x))("ngModel",r.eDate),o.xp6(1),o.Q6J("ngModel",r.range),o.xp6(9),o.Q6J("loop",!1)("pagination",!0)("slidesPerView",1),o.xp6(1),o.Q6J("ngForOf",r.profitAndExpenditures),o.xp6(2),o.Q6J("options",r.option))},dependencies:[u.sg,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.On,d.Sm,d.W2,d.Gu,d.wd,d.sr,d.oU,C.BN,m._w,b.Np,b.Y5,u.JJ],styles:["[_nghost-%COMP%]{--ion-color-primary: #EA6D35;--ion-color-primary-rgb: 56, 128, 255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255, 255, 255;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #1A2031;--ion-color-secondary-rgb: 61, 194, 255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255, 255, 255;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #F4E9E9;--ion-color-tertiary-rgb: 82, 96, 255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #f3f3f3;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9}"]})}return a})()}];let E=(()=>{class a{static#o=this.\u0275fac=function(e){return new(e||a)};static#t=this.\u0275mod=o.oAB({type:a});static#e=this.\u0275inj=o.cJS({imports:[h.Bz.forChild(v),h.Bz]})}return a})();var D=s(4850);let M=(()=>{class a{static#o=this.\u0275fac=function(e){return new(e||a)};static#t=this.\u0275mod=o.oAB({type:a});static#e=this.\u0275inj=o.cJS({imports:[D._o,D.Nu,m.Ns.forRoot({echarts:()=>s.e(1701).then(s.bind(s,1701))}),E]})}return a})()}}]);