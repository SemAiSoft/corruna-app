"use strict";(self.webpackChunkcorunna_ui=self.webpackChunkcorunna_ui||[]).push([[2934],{2934:(L,d,i)=>{i.r(d),i.d(d,{DataTemplateModule:()=>B});var c=i(9595),h=i(5861),Z=i(6308),A=i(4733),u=i(4006),f=i(5115),y=i(4327),I=i(374),g=i(8033),t=i(4650),S=i(1481),x=i(6895),C=i(2993),l=i(8118);const D=function(n){return["/core","data-template",n]};function N(n,p){if(1&n){const e=t.EpF();t.TgZ(0,"li",10),t.NdJ("click",function(){const r=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.sectorsService.selectedSector=r)}),t._uU(1),t.TgZ(2,"sup",11),t._uU(3),t.qZA()()}if(2&n){const e=p.$implicit,o=t.oxw();t.Q6J("routerLink",t.VKq(4,D,null==e?null:e.sectorName)),t.xp6(1),t.hij(" ",null==e?null:e.sectorName," "),t.xp6(2),t.AsE(" #[",(null==e||null==e.outcomeIndicators?null:e.outcomeIndicators.length)||0," , ",o.getTotalOutputIndicators(null==e?null:e.outcomeIndicators),"] ")}}function w(n,p){1&n&&(t.TgZ(0,"option"),t._uU(1,"All"),t.qZA())}function F(n,p){if(1&n&&(t.TgZ(0,"option",19),t._uU(1),t.qZA()),2&n){const e=p.$implicit;t.Q6J("value",null==e?null:e._id),t.xp6(1),t.hij(" ",null==e?null:e.sectorName," ")}}function Y(n,p){if(1&n){const e=t.EpF();t.TgZ(0,"div",12)(1,"ul",13)(2,"li",4),t._uU(3," TEMPLATE EXPORT "),t.qZA(),t.TgZ(4,"li")(5,"label"),t._uU(6,"Sector:"),t.qZA(),t.TgZ(7,"select",14,15),t.YNc(9,w,2,0,"option",16),t.YNc(10,F,2,2,"option",17),t.qZA()(),t.TgZ(11,"li")(12,"ion-button",18),t.NdJ("click",function(){t.CHM(e);const a=t.MAs(8),r=t.oxw();return t.KtG(r.exportTemplate(a))}),t._uU(13," Export "),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(9),t.Q6J("ngIf","All"==(null==e.user||null==e.user.sector?null:e.user.sector.sectorName)),t.xp6(1),t.Q6J("ngForOf",e.sectors)}}function O(n,p){if(1&n&&(t.TgZ(0,"ion-header",20)(1,"ion-toolbar",21)(2,"ion-menu-toggle",22),t._UZ(3,"ng-icon",23),t.qZA(),t.TgZ(4,"ion-title",24),t._uU(5),t.qZA()()()),2&n){const e=t.oxw();t.xp6(5),t.Oqu(e.title)}}const U=[{path:"",component:(()=>{class n{constructor(e,o,a,r,s,T,m){this.router=e,this.activatedRoute=o,this.titleService=a,this.sectorsService=r,this.toastService=s,this.dialogService=T,this.dataTemplateService=m,this.sectors=[],this.dataTemplate=new u.cw({sectorName:new u.NI(null,u.kI.required),dataGroup:new u.Oe([])})}ngOnInit(){this.user=JSON.parse(localStorage.getItem("nix-staff")||"{}"),this.activatedRoute.paramMap.subscribe(e=>{this.urlPath=e.get("sector"),this.getSectors()})}getSectors(){this.sectorsService.getSectors().subscribe(e=>{this.sectors="All"==this.user?.sector?.sectorName?e:e?.filter(o=>o?.sectorName?.toLowerCase()==this.user?.sector?.sectorName?.toLowerCase())||[],this.sectors=this.sectors?.filter(o=>"all"!==o?.sectorName?.toLowerCase())||[],e?.length&&this.router.navigate(["/core","data-template",this.sectors[0]?.sectorName])})}ionViewDidEnter(){}get title(){const e=new URL(document.URL)?.pathname;return e.split("/").at(e.split("/").length-1)?.replace("%20"," ")}get isBigScreen(){return window.innerWidth>=870}exportTemplate(e){var o=this;return(0,h.Z)(function*(){o.dataTemplateService.getSectorDataTemplate(e?.value).subscribe(function(){var a=(0,h.Z)(function*(r){r.forEach(s=>{s.outcomeIndicators?.length||(s.outcomeIndicators=[{outcomeIndicator:"",outputIndicatorsInputs:[{inputLabel:"",inputType:"",inputRequired:"",inputOptions:""}]}])}),r?._id&&!r?.length?r={title:`Sector Data Templates - ${(0,g.Z)(new Date,"d/M/yyy")}`,templates:[r]}:!r?._id&&r?.length&&(r={title:`Sector Data Templates - ${(0,g.Z)(new Date,"d/M/yyy")}`,templates:r});try{const s=yield fetch("assets/nix/data-template.xlsx").then(J=>J.arrayBuffer()),m=yield(yield(new I.Renderer).renderFromArrayBuffer(s,r)).xlsx.writeBuffer();(0,y.saveAs)(new Blob([m]),"data-templates.xlsx")}catch(s){console.log(s)}});return function(r){return a.apply(this,arguments)}}())})()}getTotalOutputIndicators(e){return e?.reduce((o,a)=>o+a?.outputIndicators?.length,0)}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(c.F0),t.Y36(c.gz),t.Y36(S.Dx),t.Y36(A.A),t.Y36(f.kl),t.Y36(f.xA),t.Y36(Z.t))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["healmah-data-template"]],decls:13,vars:3,consts:[["contentId","main-templ","when","(min-width:870px)"],["contentId","main-templ"],[1,"ion-padding-start","ion-padding-top"],[1,"w:100%","bg:rgba(0,0,0,0.05)","min-h:fit-content!","mt:40px","r:10","rr:0@<sm","py:15px"],[1,"text-center","text-decoration-underline"],[1,"f:1rem","d:flex","flex:column","gap:20px","{d:none}>li>ng-icon","{d:block}>li:hover>ng-icon","{h:35px;cursor:pointer;bb:1|dashed}>li","{br:5px|solid|var(--primary-color)}>li.active","{br:5px|solid|var(--primary-color)}>li:hover"],["routerLinkActive","active","class","rel",3,"routerLink","click",4,"ngFor","ngForOf"],["class","w:100% bg:rgba(0,0,0,0.05) min-h:fit-content! mt:40px r:10 rr:0@<sm p:10px",4,"ngIf"],["id","main-templ",1,"ion-page"],["class","height:40px! d:flex! ai:center!",4,"ngIf"],["routerLinkActive","active",1,"rel",3,"routerLink","click"],[1,"bg:blue","p:5","r:5","f:white"],[1,"w:100%","bg:rgba(0,0,0,0.05)","min-h:fit-content!","mt:40px","r:10","rr:0@<sm","p:10px"],[1,"mt:15","d:flex","flex:column","gap:20px"],[1,"form-control","form-select","shadow-none"],["sector",""],[4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["expand","block","fill","solid","shape","round",3,"click"],[3,"value"],[1,"height:40px!","d:flex!","ai:center!"],["color","primary",1,"height:40px!","ion-padding-horizontal","d:flex!","ai:center!"],["slot","start"],["name","faSolidBars",1,"f:white"],["color","light","slot","end"]],template:function(o,a){1&o&&(t.TgZ(0,"ion-split-pane",0)(1,"ion-menu",1)(2,"ion-content",2)(3,"div",3)(4,"h4",4),t._uU(5,"Sectors"),t.qZA(),t.TgZ(6,"ul",5),t.YNc(7,N,4,6,"li",6),t.qZA()(),t.YNc(8,Y,14,2,"div",7),t.qZA()(),t.TgZ(9,"div",8)(10,"ion-content"),t.YNc(11,O,6,1,"ion-header",9),t._UZ(12,"ion-router-outlet"),t.qZA()()()),2&o&&(t.xp6(7),t.Q6J("ngForOf",a.sectors),t.xp6(1),t.Q6J("ngIf","Admin"==(null==a.user?null:a.user.acctType)),t.xp6(3),t.Q6J("ngIf",!a.isBigScreen))},dependencies:[x.sg,x.O5,u.YN,u.Kr,c.rH,c.Od,C.Fv,l.YG,l.W2,l.Gu,l.z0,l.zc,l.jI,l.wd,l.sr,l.jP,l.YI]})}return n})(),children:[{path:":sector",loadChildren:()=>i.e(9868).then(i.bind(i,925)).then(n=>n.DataTemplateConfigModule)},{path:"",redirectTo:"",pathMatch:"full"}]}];let b=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(U),c.Bz]})}return n})();var v=i(4850);let B=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[v._o,v.Bu,b]})}return n})()}}]);