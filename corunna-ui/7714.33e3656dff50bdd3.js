"use strict";(self.webpackChunkcorunna_ui=self.webpackChunkcorunna_ui||[]).push([[7714],{7714:(J,d,s)=>{s.r(d),s.d(d,{SectorsModule:()=>F});var m=s(9595),f=s(4733),c=s(4006),p=s(5115),g=s(9063),l=s(8118),t=s(4650),x=s(1481),_=s(6895),h=s(2993),I=s(2216);function Z(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"ion-button",12),t.NdJ("click",function(){t.CHM(o);const n=t.oxw(),i=t.MAs(2);return n.openModal(),t.KtG(null==i?null:i.close())}),t._UZ(1,"ng-icon",13),t.qZA()}}function v(r,a){if(1&r&&(t.TgZ(0,"li",14),t._uU(1),t.qZA()),2&r){const o=a.$implicit;t.xp6(1),t.Oqu(null==o?null:o.sectorName)}}function S(r,a){if(1&r&&(t.TgZ(0,"ion-header",15)(1,"ion-toolbar",16)(2,"ion-menu-toggle",17),t._UZ(3,"ng-icon",18),t.qZA(),t.TgZ(4,"ion-title",19),t._uU(5),t.qZA()()()),2&r){const o=t.oxw();t.xp6(5),t.Oqu(o.title)}}function A(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"div",20)(1,"header",21)(2,"h2",22),t._uU(3),t.qZA()(),t.TgZ(4,"table",23)(5,"tr")(6,"td"),t._uU(7,"Total Outcome Indicators: "),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.qZA()(),t.TgZ(10,"tr")(11,"td"),t._uU(12,"Total Output Indicators: "),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.qZA()()(),t._UZ(15,"hr",24),t.TgZ(16,"footer",25)(17,"ng-icon",26),t.NdJ("click",function(){const i=t.CHM(o).$implicit,u=t.oxw();return t.KtG(u.editSector(i))}),t.qZA(),t.TgZ(18,"ng-icon",27),t.NdJ("click",function(){const i=t.CHM(o).$implicit,u=t.oxw();return t.KtG(u.deleteSector(i))}),t.qZA()()()}if(2&r){const o=a.$implicit,e=t.oxw();t.xp6(3),t.Oqu(null==o?null:o.sectorName),t.xp6(6),t.Oqu((null==o||null==o.outcomeIndicators?null:o.outcomeIndicators.length)||0),t.xp6(5),t.Oqu(e.getTotalOutputIndicators(null==o?null:o.outcomeIndicators)||0)}}function b(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"ion-buttons",40),t.NdJ("click",function(){t.CHM(o);const n=t.oxw(2);return t.KtG(null==n.modal?null:n.modal.dismiss())}),t._UZ(1,"ion-back-button",41),t.qZA()}}function T(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"div",53)(1,"span",54),t._uU(2),t.qZA(),t._UZ(3,"input",55),t.TgZ(4,"span",56),t.NdJ("click",function(){const i=t.CHM(o).index,u=t.oxw().index,U=t.oxw(2);return t.KtG(U.removeOutputIndicator(u,i))}),t._UZ(5,"ng-icon",48),t.qZA()()}if(2&r){const o=a.index,e=t.oxw().index,n=t.oxw(2);let i;t.xp6(2),t.hij(" #",((null==(i=n.getOutputIndicatorsArr(e))||null==i.controls?null:i.controls.length)||0)-o," "),t.xp6(1),t.Q6J("formControlName",o)}}function C(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"div",42)(1,"div",43)(2,"div",44)(3,"div",45)(4,"span"),t._uU(5),t.qZA(),t._UZ(6,"input",46),t.TgZ(7,"span",47),t.NdJ("click",function(){const i=t.CHM(o).index,u=t.oxw(2);return t.KtG(u.removeOutcomeIndicator(i))}),t._UZ(8,"ng-icon",48),t.qZA()(),t.TgZ(9,"h4",49),t._uU(10," Output Indicators: "),t.TgZ(11,"span",50),t.NdJ("click",function(){const i=t.CHM(o).index,u=t.oxw(2);return t.KtG(u.addOutputIndicator(i))}),t._UZ(12,"ng-icon",13),t.qZA()(),t.TgZ(13,"div",51),t.YNc(14,T,6,2,"div",52),t.qZA()()()()}if(2&r){const o=a.index,e=t.oxw(2);let n;t.xp6(2),t.Q6J("formGroupName",o),t.xp6(3),t.hij(" #",((null==e.outcomeIndicatorsArr||null==e.outcomeIndicatorsArr.controls?null:e.outcomeIndicatorsArr.controls.length)||0)-o,"# "),t.xp6(9),t.Q6J("ngForOf",null==(n=e.getOutputIndicatorsArr(o))?null:n.controls)}}function w(r,a){if(1&r){const o=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar",28),t.YNc(2,b,2,0,"ion-buttons",29),t.TgZ(3,"ion-title",30),t._UZ(4,"fa-icon",31),t._uU(5," Sector Form "),t.TgZ(6,"button",32),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.saveSector())}),t._uU(7,"Save"),t.qZA()()()(),t.TgZ(8,"ion-content",33)(9,"form",34)(10,"div")(11,"label"),t._uU(12,"Sector Name:"),t.qZA(),t._UZ(13,"input",35),t.qZA(),t.TgZ(14,"h4",36),t._uU(15," Outcome Indicators: "),t.TgZ(16,"button",37),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.addOutcomeIndicator())}),t._UZ(17,"ng-icon",13),t.qZA()(),t.TgZ(18,"div",38),t.YNc(19,C,15,3,"div",39),t.qZA()()()}if(2&r){const o=t.oxw();t.xp6(2),t.Q6J("ngIf",!o.isBigScreen),t.xp6(7),t.Q6J("formGroup",o.sectorForm),t.xp6(10),t.Q6J("ngForOf",null==o.outcomeIndicatorsArr?null:o.outcomeIndicatorsArr.controls)}}const O=[{path:"",component:(()=>{class r{constructor(o,e,n,i){this.titleService=o,this.sectorsService=e,this.toastService=n,this.dialogService=i,this.sectors=[],this.sectorForm=new c.cw({sectorName:new c.NI(null,c.kI.required),outcomeIndicators:new c.Oe([])})}ngOnInit(){this.outcomeIndicatorsArr.length||this.addOutcomeIndicator()}get outcomeIndicatorsArr(){return this.sectorForm.get("outcomeIndicators")}outcomeIndicator(o,e=0){return new c.cw({outcomeIndicator:new c.NI(o?.outcomeIndicator??null,c.kI.required),outputIndicators:new c.Oe([])})}addOutcomeIndicator(o,e=0){this.outcomeIndicatorsArr.insert(e,this.outcomeIndicator(o,e)),o&&o?.outputIndicators?.forEach((n,i)=>{this.addOutputIndicator(e,i,n)})}removeOutcomeIndicator(o){this.outcomeIndicatorsArr.removeAt(o)}getOutputIndicatorsArr(o=0){return this.outcomeIndicatorsArr.at(o)?.get("outputIndicators")}outputIndicatorItem(o){return new c.NI(o??null,c.kI.required)}addOutputIndicator(o=0,e=0,n){this.getOutputIndicatorsArr(o).insert(e,this.outputIndicatorItem(n))}removeOutputIndicator(o=0,e=0){this.getOutputIndicatorsArr(o).removeAt(e)}get title(){return this.titleService.getTitle()}openModal(){this.modal.present().then(o=>{!this.sectorForm.get("_id")?.value&&!this.outcomeIndicatorsArr.length&&this.addOutcomeIndicator(),this.modal.onDidDismiss().then(e=>{this.getSectors()})})}get isBigScreen(){return window.innerWidth>=870}ionViewDidEnter(){this.user=JSON.parse(localStorage.getItem("nix-staff")||"{}"),this.getSectors()}getTotalOutputIndicators(o){return o?.reduce((e,n)=>e+n?.outputIndicators?.length,0)}saveSector(){this.sectorForm.invalid?this.toastService.toast({type:"danger",title:"Input Error",message:g.xR.invalidForm,position:"center-center"}):this.sectorsService.saveSector(this.sectorForm.value).subscribe(o=>{o?._id&&(this.toastService.toast({type:"success",title:"Operation Success",message:g.kt.formSaved,position:"center-center"}),this.sectorForm.reset())})}getSectors(){this.sectorsService.getSectors().subscribe(o=>{this.sectors="All"==this.user?.sector?.sectorName?o:o?.filter(e=>e?.sectorName?.toLowerCase()==this.user?.sector?.sectorName?.toLowerCase())||[],this.sectors=this.sectors?.filter(e=>"all"!==e?.sectorName?.toLowerCase())||[]})}deleteSector(o){this.dialogService.openConfirmDialog({title:"Comfirm Action",message:"Are you sure to delete this sector?"}).subscribe(e=>{e&&this.sectorsService.deleteSector(o?._id).subscribe(n=>{n?._id&&this.getSectors()})})}editSector(o){this.sectorForm=new c.cw({_id:new c.NI(o?._id),sectorName:new c.NI(o?.sectorName,c.kI.required),outcomeIndicators:new c.Oe([])}),o?.outcomeIndicators?.forEach((e,n)=>{this.addOutcomeIndicator(e,n)}),this.modal?.present(),this.modal.onDidDismiss().then(e=>{this.getSectors()})}static#t=this.\u0275fac=function(e){return new(e||r)(t.Y36(x.Dx),t.Y36(f.A),t.Y36(p.kl),t.Y36(p.xA))};static#o=this.\u0275cmp=t.Xpm({type:r,selectors:[["healmah-sectors"]],viewQuery:function(e,n){if(1&e&&t.Gf(l.ki,5),2&e){let i;t.iGM(i=t.CRH())&&(n.modal=i.first)}},decls:14,vars:4,consts:[["contentId","sector-menu","when","(min-width:870px)"],["contentId","sector-menu"],["menu",""],[1,"ion-padding-start","ion-padding-top"],[1,"w:100%","bg:rgba(0,0,0,0.05)","min-h:fit-content!","mt:40px","r:10","rr:0@<sm","py:15px","d:flex","flex:column","gap:20px","px:20px"],["expand","block","fill","solid",3,"click",4,"ngIf"],[1,"d:flex","flex:column","gap:20px","p:0","f:1rem"],["class","bb:1|dashed",4,"ngFor","ngForOf"],["id","sector-menu"],["class","height:40px! d:flex! ai:center!",4,"ngIf"],[1,"mt:20","p:10","grid-cols:1","grid-cols:2@>xs","gap:10","{box-shadow:0|0|10px|rgba(0,0,0,0.2)}>div"],["class","min-h:200px r:5 flex gap:10 flex:column jc:space-between p:10",4,"ngFor","ngForOf"],["expand","block","fill","solid",3,"click"],["name","faSolidPlus"],[1,"bb:1|dashed"],[1,"height:40px!","d:flex!","ai:center!"],["color","primary",1,"height:40px!","ion-padding-horizontal","d:flex!","ai:center!"],["slot","start"],["name","faSolidBars",1,"f:white"],["color","light","slot","end"],[1,"min-h:200px","r:5","flex","gap:10","flex:column","jc:space-between","p:10"],[1,"bg:rgba(0,0,0,0.1)"],[1,"text-center"],[1,"{px:30}_td","f:1rem"],[1,"w:50%","mx:auto"],[1,"transition:all|0.4s|ease","flex","jc:space-between","p:5|10","{cursor:pointer}>*","{scale:1.3}>*:hover"],["name","faSolidPen",1,"f:blue",3,"click"],["name","faSolidTrash",1,"text-danger",3,"click"],["color","primary",1,"ion-padding-horizontal"],["slot","start",3,"click",4,"ngIf"],[1,"text-align:center!","d:flex!","gap:10"],["icon","book-open",1,"mr:20"],[1,"btn","btn-sm","btn-success","ml:20",3,"click"],[1,"ion-padding"],[1,"p:20",3,"formGroup"],["formControlName","sectorName",1,"form-control","shadow-none"],[1,"mt:15","d:flex","gap:4"],[1,"btn","btn-sm","btn-primary",3,"click"],["formArrayName","outcomeIndicators"],["class","display:flex flex:column gap:10 mt:10",4,"ngFor","ngForOf"],["slot","start",3,"click"],["defaultHref",""],[1,"display:flex","flex:column","gap:10","mt:10"],[1,"b:2|solid|sky/.3","p:5"],[3,"formGroupName"],[1,"flex","gap:3","ai:center"],["placeholder","Outcome","formControlName","outcomeIndicator",1,"form-control","shadow-none"],[1,"btn","btn-sm","btn-outline-warning","d:flex!","ai:center!",3,"click"],["name","faSolidMinus"],[1,"d:flex!","ai:center","gap:10","mt:10","px:15"],[1,"btn","btn-sm","btn-outline-secondary","d:flex!","ai:center!",3,"click"],["formArrayName","outputIndicators",1,"px:15","flex","flex:column","gap:10"],["class","flex ai:center gap:5 mb:5",4,"ngFor","ngForOf"],[1,"flex","ai:center","gap:5","mb:5"],[1,"f:1rem"],["placeholder","Outcome",1,"form-control","shadow-none",3,"formControlName"],[1,"btn","btn-sm","btn-outline-danger","d:flex!","ai:center!",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-split-pane",0)(1,"ion-menu",1,2)(3,"ion-content",3)(4,"div",4),t.YNc(5,Z,2,0,"ion-button",5),t.TgZ(6,"ul",6),t.YNc(7,v,2,1,"li",7),t.qZA()()()(),t.TgZ(8,"ion-content",8),t.YNc(9,S,6,1,"ion-header",9),t.TgZ(10,"main",10),t.YNc(11,A,19,3,"div",11),t.qZA(),t.TgZ(12,"ion-modal"),t.YNc(13,w,20,3,"ng-template"),t.qZA()()()),2&e&&(t.xp6(5),t.Q6J("ngIf","All"==(null==n.user||null==n.user.sector?null:n.user.sector.sectorName)),t.xp6(2),t.Q6J("ngForOf",n.sectors),t.xp6(2),t.Q6J("ngIf",!n.isBigScreen),t.xp6(2),t.Q6J("ngForOf",n.sectors))},dependencies:[_.sg,_.O5,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,h.Fv,l.YG,l.Sm,l.W2,l.Gu,l.z0,l.zc,l.jI,l.wd,l.sr,l.ki,l.oU,I.BN]})}return r})()}];let N=(()=>{class r{static#t=this.\u0275fac=function(e){return new(e||r)};static#o=this.\u0275mod=t.oAB({type:r});static#e=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(O),m.Bz]})}return r})();var k=s(4850);let F=(()=>{class r{static#t=this.\u0275fac=function(e){return new(e||r)};static#o=this.\u0275mod=t.oAB({type:r});static#e=this.\u0275inj=t.cJS({imports:[k._o,N]})}return r})()}}]);