"use strict";(self.webpackChunkcorunna_ui=self.webpackChunkcorunna_ui||[]).push([[7035],{7035:(P,p,n)=>{n.r(p),n.d(p,{GamePlayPageModule:()=>Z});var f=n(9595),b=n(5861),A=n(6059),o=n(4006),s=n(2958),l=n(4850),c=n(9063),d=n(9652),e=n(4650),v=n(6895),h=n(6726),m=n(8118),y=n(2216),N=n(1191);function I(i,G){if(1&i){const r=e.EpF();e.TgZ(0,"div")(1,"div",17)(2,"div",18)(3,"label"),e._uU(4,"Game Name:"),e.qZA(),e.TgZ(5,"input",19),e.NdJ("typeaheadOnSelect",function(a){const u=e.CHM(r).index,C=e.MAs(10);return e.oxw().gameSelected(a,u),e.KtG(C.focus())}),e.qZA()(),e.TgZ(6,"div",20)(7,"label"),e._uU(8,"x:"),e.qZA(),e.TgZ(9,"input",21,22),e.NdJ("input",function(){e.CHM(r);const a=e.oxw();return e.KtG(a.numOfTimesChanged())}),e.qZA()(),e.TgZ(11,"div",23)(12,"label"),e._uU(13,"PM:"),e.qZA(),e.TgZ(14,"select",24)(15,"option",25),e._uU(16,"Cash"),e.qZA(),e.TgZ(17,"option",26),e._uU(18,"Bank"),e.qZA()()(),e.TgZ(19,"fa-icon",27),e.NdJ("click",function(){const g=e.CHM(r).index,u=e.oxw();return e.KtG(u.removeGameItem(g))}),e.qZA()()()}if(2&i){const r=G.index,t=e.oxw();e.xp6(1),e.Q6J("formGroupName",r),e.xp6(4),e.Q6J("typeahead",t.gameList)("typeaheadOptionsLimit",15)}}const x=[{path:"",component:(()=>{class i{constructor(r,t,a){this.localStorageService=r,this.gameService=t,this.router=a,this.totalAmount=0,this.gameList=[],this.process=g=>this.gamePlayForm.invalid?(s.F.show({text:c.xR.invalidForm,duration:"long",position:"top"}),Promise.resolve()):this.gameService.playGame(this.gamePlayForm.value),this.gamePlayForm=new o.cw({gameItems:new o.Oe([this.gameItemGroup()],o.kI.required),playerName:new o.NI(null),idempotencyKey:new o.NI((0,d.x0)())})}ngOnInit(){this.staff=JSON.parse(this.localStorageService.get("staff-profile")||"{}"),this.gameService.getGames().subscribe(r=>{this.gameList=r?.map(t=>({gameName:t.gameName,gameCost:t.gameCost,displayName:t.gameName+" ("+t.gameCost+")"}))})}gameItemGroup(r){return new o.cw({gameName:new o.NI(null,o.kI.required),gameCost:new o.NI(null,[o.kI.required,o.kI.min(1)]),payMethod:new o.NI("Cash",o.kI.required),numOfTimes:new o.NI(1,[o.kI.required,o.kI.min(1)])})}get gameItemArr(){return this.gamePlayForm.get("gameItems")}addGameItem(){this.gameItemArr.controls.at(0)?.get("gameName")?.valid&&this.gameItemArr.controls.at(0)?.get("numOfTimes")?.valid&&this.gameItemArr.insert(0,this.gameItemGroup())}removeGameItem(r){this.gameItemArr.length>1&&(this.gameItemArr.removeAt(r),this.calculateTotal())}gameSelected(r,t){const a=r.item;if(this.gameItemArr.controls.filter(g=>g.get("gameName")?.value==a.gameName).length>=1)return this.gameItemArr.controls.at(t)?.get("gameName")?.reset(),void s.F.show({text:"Game already selected, please choose another",position:"bottom",duration:"long"});this.gameItemArr.at(t)?.get("gameName")?.setValue(a.gameName),this.gameItemArr.at(t)?.get("gameCost")?.setValue(a.gameCost),this.calculateTotal()}numOfTimesChanged(){this.calculateTotal()}calculateTotal(){this.totalAmount=this.gameItemArr.controls.reduce((r,t)=>r+parseFloat(t.get("gameCost")?.value)*parseFloat(t.get("numOfTimes")?.value),0)}result(r){var t=this;return(0,b.Z)(function*(){r?._id&&(yield s.F.show({text:"Sale processed successfully",duration:"long",position:"top"}),t.resetForm(),t.gameService.updateReport.next(!0))})()}resetForm(){this.gamePlayForm.reset(),this.gameItemArr.clear(),this.gameItemArr.insert(0,this.gameItemGroup()),this.totalAmount=0,this.gamePlayForm.get("idempotencyKey")?.setValue((0,d.x0)())}closeModal(){this.router.navigate(["Super"==this.staff.acctType?"/super/game-home":this.staff.acctType?.toLowerCase()])}static#e=this.\u0275fac=function(t){return new(t||i)(e.Y36(l.n2),e.Y36(A.h),e.Y36(f.F0))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["healmah-game-play"]],hostBindings:function(t,a){1&t&&e.NdJ("popstate",function(u){return a.closeModal(u)},!1,e.Jf7)},decls:27,vars:6,consts:[["color","primary"],["slot","start"],["color","light",3,"defaultHref"],["slot","end","color","light"],["color","tertiary",1,"ion-padding"],[1,"p:10","flex","my:40","flex:column","gap:10","{flex;flex:column;gap:15}>div","{f:black}_label","{b:#0F85E9!}_input","{b:#0F85E9!}_select","print-none",3,"formGroup"],["formArrayName","gameItems"],[4,"ngFor","ngForOf"],[1,"f:blue"],["formControlName","playerName","placeholder","optional","type","text",1,"form-control"],["btnDisabler","",1,"btn","btn-outline-primary","mt:25",3,"handler","disableWhenProcessing","handle"],[1,"btn","btn-outline-warning","mt:15",3,"click"],["slot","fixed","vertical","top","horizontal","start"],["size","small",3,"click"],["name","add"],["slot","fixed","vertical","top","horizontal","end"],[1,"text-decoration-line-through","text-decoration-style:double"],[1,"flex","gap:3",3,"formGroupName"],[1,"mt:10","flex:1"],["type","text","formControlName","gameName","typeaheadOptionField","displayName","container","body",1,"form-control","rr:0!",3,"typeahead","typeaheadOptionsLimit","typeaheadOnSelect"],[1,"mt:10","flex-basis:35px"],["type","number","formControlName","numOfTimes",1,"form-control","rl:0!","rr:0!","px:0","pl:5!",3,"input"],["qtty",""],[1,"mt:10","flex-basis:55px"],["formControlName","payMethod",1,"form-control","form-select","pl:5!","rl:0!","rr:0!"],["value","Cash"],["value","Bank"],["icon","minus",1,"btn","btn-outline-warning","align-self-end","rl:0!",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title",3),e._uU(5,"Play A Game"),e.qZA()()(),e.TgZ(6,"ion-content",4)(7,"form",5)(8,"div",6),e.YNc(9,I,20,3,"div",7),e.qZA(),e._UZ(10,"hr",8),e.TgZ(11,"div")(12,"label"),e._uU(13,"Player Name:"),e.qZA(),e._UZ(14,"input",9),e.qZA(),e.TgZ(15,"button",10),e.NdJ("handle",function(u){return a.result(u)}),e._uU(16,"Process"),e.qZA(),e.TgZ(17,"button",11),e.NdJ("click",function(){return a.resetForm()}),e._uU(18,"Reset"),e.qZA()(),e.TgZ(19,"ion-fab",12)(20,"ion-fab-button",13),e.NdJ("click",function(){return a.addGameItem()}),e._UZ(21,"ion-icon",14),e.qZA()(),e.TgZ(22,"ion-fab",15)(23,"ion-fab-button")(24,"span",16),e._uU(25,"N"),e.qZA(),e._uU(26),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("defaultHref",null==a.staff||null==a.staff.acctType?null:a.staff.acctType.toLowerCase()),e.xp6(4),e.Q6J("formGroup",a.gamePlayForm),e.xp6(2),e.Q6J("ngForOf",null==a.gameItemArr?null:a.gameItemArr.controls),e.xp6(6),e.Q6J("handler",a.process)("disableWhenProcessing",!0),e.xp6(11),e.hij("",a.totalAmount," "))},dependencies:[v.sg,o._Y,o.YN,o.Kr,o.Fj,o.wV,o.EJ,o.JJ,o.JL,o.sg,o.u,o.x0,o.CE,h.h,m.Sm,m.W2,m.IJ,m.W4,m.Gu,m.gu,m.wd,m.sr,m.oU,y.BN,N.Bp],styles:["[_nghost-%COMP%]{--ion-color-primary: #1F5BBC;--ion-color-primary-rgb: 56, 128, 255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255, 255, 255;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #3dc2ff;--ion-color-secondary-rgb: 61, 194, 255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255, 255, 255;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #f3f3f3;--ion-color-tertiary-rgb: 82, 96, 255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9}"]})}return i})()}];let T=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({imports:[f.Bz.forChild(x),f.Bz]})}return i})(),Z=(()=>{class i{static#e=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({imports:[l._o,l.Nu,T]})}return i})()},9652:(P,p,n)=>{n.d(p,{x0:()=>o});let o=(s=21)=>crypto.getRandomValues(new Uint8Array(s)).reduce((l,c)=>l+((c&=63)<36?c.toString(36):c<62?(c-26).toString(36).toUpperCase():c>62?"-":"_"),"")}}]);