"use strict";(self.webpackChunkcorunna_ui=self.webpackChunkcorunna_ui||[]).push([[2872],{2872:(x,u,i)=>{i.r(u),i.d(u,{GamePlayPageModule:()=>T});var c=i(9595),d=i(5861),h=i(8727),o=i(4006),g=i(2958),f=i(4850),p=i(9063),e=i(4650),y=i(6895),b=i(6726),l=i(8118),v=i(2216),P=i(1191);function A(n,Z){if(1&n){const r=e.EpF();e.TgZ(0,"div")(1,"div",17)(2,"div",18)(3,"label"),e._uU(4,"Game Name:"),e.qZA(),e.TgZ(5,"input",19),e.NdJ("typeaheadOnSelect",function(a){const m=e.CHM(r).index,G=e.MAs(10);return e.oxw().gameSelected(a,m),e.KtG(G.focus())}),e.qZA()(),e.TgZ(6,"div",20)(7,"label"),e._uU(8,"x:"),e.qZA(),e.TgZ(9,"input",21,22),e.NdJ("input",function(){e.CHM(r);const a=e.oxw();return e.KtG(a.numOfTimesChanged())}),e.qZA()(),e.TgZ(11,"div",23)(12,"label"),e._uU(13,"PM:"),e.qZA(),e.TgZ(14,"select",24)(15,"option",25),e._uU(16,"Cash"),e.qZA(),e.TgZ(17,"option",26),e._uU(18,"Bank"),e.qZA()()(),e.TgZ(19,"fa-icon",27),e.NdJ("click",function(){const s=e.CHM(r).index,m=e.oxw();return e.KtG(m.removeGameItem(s))}),e.qZA()()()}if(2&n){const r=Z.index,t=e.oxw();e.xp6(1),e.Q6J("formGroupName",r),e.xp6(4),e.Q6J("typeahead",t.gameList)("typeaheadOptionsLimit",15)}}const N=[{path:"",component:(()=>{class n{constructor(r,t,a){this.localStorageService=r,this.gameService=t,this.router=a,this.totalAmount=0,this.gameList=[],this.process=s=>this.gamePlayForm.invalid?(g.F.show({text:p.xR.invalidForm,duration:"long",position:"top"}),Promise.resolve()):this.gameService.playGame(this.gamePlayForm.value),this.gamePlayForm=new o.cw({gameItems:new o.Oe([this.gameItemGroup()],o.kI.required),playerName:new o.NI(null)})}ngOnInit(){this.staff=JSON.parse(this.localStorageService.get("staff-profile")||"{}"),this.gameService.getGames().subscribe(r=>{this.gameList=r?.map(t=>({gameName:t.gameName,gameCost:t.gameCost,displayName:t.gameName+" ("+t.gameCost+")"}))})}gameItemGroup(r){return new o.cw({gameName:new o.NI(null,o.kI.required),gameCost:new o.NI(null,[o.kI.required,o.kI.min(1)]),payMethod:new o.NI("Cash",o.kI.required),numOfTimes:new o.NI(1,[o.kI.required,o.kI.min(1)])})}get gameItemArr(){return this.gamePlayForm.get("gameItems")}addGameItem(){this.gameItemArr.controls.at(0)?.get("gameName")?.valid&&this.gameItemArr.controls.at(0)?.get("numOfTimes")?.valid&&this.gameItemArr.insert(0,this.gameItemGroup())}removeGameItem(r){this.gameItemArr.length>1&&(this.gameItemArr.removeAt(r),this.calculateTotal())}gameSelected(r,t){const a=r.item;if(this.gameItemArr.controls.filter(s=>s.get("gameName")?.value==a.gameName).length>=1)return this.gameItemArr.controls.at(t)?.get("gameName")?.reset(),void g.F.show({text:"Game already selected, please choose another",position:"bottom",duration:"long"});this.gameItemArr.at(t)?.get("gameName")?.setValue(a.gameName),this.gameItemArr.at(t)?.get("gameCost")?.setValue(a.gameCost),this.calculateTotal()}numOfTimesChanged(){this.calculateTotal()}calculateTotal(){this.totalAmount=this.gameItemArr.controls.reduce((r,t)=>r+parseFloat(t.get("gameCost")?.value)*parseFloat(t.get("numOfTimes")?.value),0)}result(r){var t=this;return(0,d.Z)(function*(){r?._id&&(yield g.F.show({text:"Sale processed successfully",duration:"long",position:"top"}),t.resetForm(),t.gameService.updateReport.next(!0))})()}resetForm(){this.gamePlayForm.reset(),this.gameItemArr.clear(),this.gameItemArr.insert(0,this.gameItemGroup()),this.totalAmount=0}closeModal(){this.router.navigate(["Super"==this.staff.acctType?"/super/game-home":this.staff.acctType?.toLowerCase()])}static#e=this.\u0275fac=function(t){return new(t||n)(e.Y36(f.n2),e.Y36(h.h),e.Y36(c.F0))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["healmah-game-play"]],hostBindings:function(t,a){1&t&&e.NdJ("popstate",function(m){return a.closeModal(m)},!1,e.Jf7)},decls:27,vars:6,consts:[["color","secondary"],["slot","start"],["color","light",3,"defaultHref"],["slot","end","color","light"],["color","primary",1,"ion-padding"],[1,"p:10","flex","my:40","flex:column","gap:10","{flex;flex:column;gap:15}>div","{f:white}_label","{b:#0F85E9!}_input","{b:#0F85E9!}_select","print-none",3,"formGroup"],["formArrayName","gameItems"],[4,"ngFor","ngForOf"],[1,"f:blue"],["formControlName","playerName","placeholder","optional","type","text",1,"form-control"],["btnDisabler","",1,"btn","btn-outline-primary","mt:25",3,"handler","disableWhenProcessing","handle"],[1,"btn","btn-outline-warning","mt:15",3,"click"],["slot","fixed","vertical","top","horizontal","start"],["size","small",3,"click"],["name","add"],["slot","fixed","vertical","top","horizontal","end"],[1,"text-decoration-line-through","text-decoration-style:double"],[1,"flex","gap:3",3,"formGroupName"],[1,"mt:10","flex:1"],["type","text","formControlName","gameName","typeaheadOptionField","displayName","container","body",1,"form-control","rr:0!",3,"typeahead","typeaheadOptionsLimit","typeaheadOnSelect"],[1,"mt:10","flex-basis:35px"],["type","number","formControlName","numOfTimes",1,"form-control","rl:0!","rr:0!","px:0","pl:5!",3,"input"],["qtty",""],[1,"mt:10","flex-basis:55px"],["formControlName","payMethod",1,"form-control","form-select","pl:5!","rl:0!","rr:0!"],["value","Cash"],["value","Bank"],["icon","minus",1,"btn","btn-outline-warning","align-self-end","rl:0!",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title",3),e._uU(5,"Play A Game"),e.qZA()()(),e.TgZ(6,"ion-content",4)(7,"form",5)(8,"div",6),e.YNc(9,A,20,3,"div",7),e.qZA(),e._UZ(10,"hr",8),e.TgZ(11,"div")(12,"label"),e._uU(13,"Player Name:"),e.qZA(),e._UZ(14,"input",9),e.qZA(),e.TgZ(15,"button",10),e.NdJ("handle",function(m){return a.result(m)}),e._uU(16,"Process"),e.qZA(),e.TgZ(17,"button",11),e.NdJ("click",function(){return a.resetForm()}),e._uU(18,"Reset"),e.qZA()(),e.TgZ(19,"ion-fab",12)(20,"ion-fab-button",13),e.NdJ("click",function(){return a.addGameItem()}),e._UZ(21,"ion-icon",14),e.qZA()(),e.TgZ(22,"ion-fab",15)(23,"ion-fab-button")(24,"span",16),e._uU(25,"N"),e.qZA(),e._uU(26),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("defaultHref",null==a.staff||null==a.staff.acctType?null:a.staff.acctType.toLowerCase()),e.xp6(4),e.Q6J("formGroup",a.gamePlayForm),e.xp6(2),e.Q6J("ngForOf",null==a.gameItemArr?null:a.gameItemArr.controls),e.xp6(6),e.Q6J("handler",a.process)("disableWhenProcessing",!0),e.xp6(11),e.hij("",a.totalAmount," "))},dependencies:[y.sg,o._Y,o.YN,o.Kr,o.Fj,o.wV,o.EJ,o.JJ,o.JL,o.sg,o.u,o.x0,o.CE,b.h,l.Sm,l.W2,l.IJ,l.W4,l.Gu,l.gu,l.wd,l.sr,l.oU,v.BN,P.Bp],styles:["[_nghost-%COMP%]{--ion-color-primary: #333B46;--ion-color-primary-rgb: 56, 128, 255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255, 255, 255;--ion-color-primary-shade: #333B46;--ion-color-primary-tint: #333B46;--ion-color-secondary: #1F2630;--ion-color-secondary-rgb: 61, 194, 255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255, 255, 255;--ion-color-secondary-shade: #1F2630;--ion-color-secondary-tint: #1F2630;--ion-color-tertiary: #f3f3f3;--ion-color-tertiary-rgb: 82, 96, 255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9}"]})}return n})()}];let I=(()=>{class n{static#e=this.\u0275fac=function(t){return new(t||n)};static#t=this.\u0275mod=e.oAB({type:n});static#o=this.\u0275inj=e.cJS({imports:[c.Bz.forChild(N),c.Bz]})}return n})(),T=(()=>{class n{static#e=this.\u0275fac=function(t){return new(t||n)};static#t=this.\u0275mod=e.oAB({type:n});static#o=this.\u0275inj=e.cJS({imports:[f._o,f.Nu,I]})}return n})()}}]);