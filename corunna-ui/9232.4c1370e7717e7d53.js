"use strict";(self.webpackChunkcorunna_ui=self.webpackChunkcorunna_ui||[]).push([[9232],{9232:(B,u,r)=>{r.r(u),r.d(u,{PurchasePageModule:()=>S});var m=r(9595),g=r(5861),b=(r(9063),r(7407)),y=r(4201),s=r(8118),p=r(9809),o=r(4650),v=r(2412),C=r(2879);const M=function(){return["cost"]},Z=[{path:"",component:(()=>{class i{constructor(e,t,n,c){var l,a=this;this.stockService=e,this.platform=t,this.menuService=n,this.modalCtrl=c,this.purchases=[],this.shopBranches=[],this.purchaseVendors=[],this.tableData=[],this.itemCostWorth=0,this.itemsCostWorth=0,this.activePage=0,this.oldStockList=[],this.columns=[{field:"sno",header:this.platform.platforms().includes("mobile")?"S/N":"S/NO"},{field:"vendor",header:"VENDOR"},{field:"itemsCount",header:"ITEMS COUNT"},{field:"cost",header:"COST"},{field:"shopBranch",header:"BRANCH"}],this.menuList=[{iconLeft:"pen-alt",name:"Edit Purchase",clickAction:(l=(0,g.Z)(function*(){const d=a.menuService.contextRow.rowData,P=a.purchases.find(h=>h._id==d?._id);if(a.menuService.closeAllMenu(),P){const h=yield a.modalCtrl.create({component:p.Y,breakpoints:[0,.75,.85],initialBreakpoint:.75,backdropDismiss:!1,cssClass:"sheetModal",componentProps:{data:{purchase:P}}});h?.present().then(T=>{}),h.onDidDismiss().then(T=>{a.getPurchases()})}}),function(){return l.apply(this,arguments)})}]}ngOnInit(){this.getPurchases()}closeModal(){this.modal?.dismiss()}getPurchases(e){this.stockService.getPurchases().subscribe(t=>{e&&e.target.complete(),this.purchases=t,this.tableData=t?.map((n,c)=>({_id:n?._id,sno:c+1,vendor:n.vendor,itemsPurchased:n.itemsPurchased,itemsCount:n.itemsPurchased.length??0,shopBranch:n?.shopBranch?.branchName,cost:n.itemsPurchased.reduce((a,l)=>a+(l?.quantity??0)*(l.unitCostPrice??0),0)}))})}openModal(){var e=this;return(0,g.Z)(function*(){const t=yield e.modalCtrl.create({component:p.Y,breakpoints:[0,.75,.85],initialBreakpoint:.75,backdropDismiss:!1,cssClass:"sheetModal"});t?.present().then(n=>{}),t.onDidDismiss().then(n=>{e.getPurchases()})})()}static#o=this.\u0275fac=function(t){return new(t||i)(o.Y36(b.q),o.Y36(v.t4),o.Y36(y.hl),o.Y36(s.IN))};static#t=this.\u0275cmp=o.Xpm({type:i,selectors:[["healmah-purchase"]],viewQuery:function(t,n){if(1&t&&o.Gf(s.ki,7),2&t){let c;o.iGM(c=o.CRH())&&(n.modal=c.first)}},hostBindings:function(t,n){1&t&&o.NdJ("popstate",function(a){return n.closeModal(a)},!1,o.Jf7)},decls:18,vars:7,consts:[["color","primary"],["slot","start"],["color","light","defaultHref","super"],["slot","start","color","light"],["color","light"],["slot","fixed",3,"ionRefresh"],[3,"columns","data","isCustomCaption","rowContextMenu","currencyFields","rowsPerPage"],["table",""],["caption","",1,"d-flex","gap-1"],[1,"flex","ai:center","gap:5","bg:white","flex:1","pl:10","r:5"],[1,"pi","pi-search"],["type","search","placeholder","Search",1,"form-control","shadow:none!","ps-3","b:none!",3,"input"],[3,"click"],["slot","icon-only","name","add"]],template:function(t,n){if(1&t){const c=o.EpF();o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),o._UZ(3,"ion-back-button",2),o.qZA(),o.TgZ(4,"ion-title",3),o._uU(5,"Stock Purchase"),o.qZA()()(),o.TgZ(6,"ion-content",4)(7,"ion-refresher",5),o.NdJ("ionRefresh",function(l){return n.getPurchases(l)}),o._UZ(8,"ion-refresher-content"),o.qZA(),o.TgZ(9,"prime-table",6,7)(11,"caption",8)(12,"span",9),o._UZ(13,"i",10),o.TgZ(14,"input",11),o.NdJ("input",function(l){o.CHM(c);const d=o.MAs(10);return o.KtG(d.searchTable(l))}),o.qZA()(),o.TgZ(15,"ion-button",12),o.NdJ("click",function(){return n.openModal()}),o._UZ(16,"ion-icon",13),o.qZA()(),o._uU(17," > "),o.qZA()()}2&t&&(o.xp6(9),o.Q6J("columns",n.columns)("data",n.tableData)("isCustomCaption",!0)("rowContextMenu",n.menuList)("currencyFields",o.DdM(6,M))("rowsPerPage",25))},dependencies:[s.YG,s.Sm,s.W2,s.Gu,s.gu,s.nJ,s.Wo,s.wd,s.sr,s.oU,C.I],styles:["[_nghost-%COMP%]{--ion-color-primary: #EA6D35;--ion-color-primary-rgb: 56, 128, 255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255, 255, 255;--ion-color-primary-shade: #3171e0;--ion-color-primary-tint: #4c8dff;--ion-color-secondary: #1A2031;--ion-color-secondary-rgb: 61, 194, 255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255, 255, 255;--ion-color-secondary-shade: #36abe0;--ion-color-secondary-tint: #50c8ff;--ion-color-tertiary: #F4E9E9;--ion-color-tertiary-rgb: 82, 96, 255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #4854e0;--ion-color-tertiary-tint: #6370ff;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #f3f3f3;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9}"]})}return i})()}];let k=(()=>{class i{static#o=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=o.oAB({type:i});static#n=this.\u0275inj=o.cJS({imports:[m.Bz.forChild(Z),m.Bz]})}return i})();var f=r(4850),A=r(5115);let S=(()=>{class i{static#o=this.\u0275fac=function(t){return new(t||i)};static#t=this.\u0275mod=o.oAB({type:i});static#n=this.\u0275inj=o.cJS({imports:[f._o,f.Nu,A.gw,f.wq,k]})}return i})()}}]);